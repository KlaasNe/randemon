(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{43:function(e,a,t){e.exports=t(90)},48:function(e,a,t){},49:function(e,a,t){},87:function(e,a){},90:function(e,a,t){"use strict";t.r(a);var r=t(1),n=t.n(r),i=t(35),l=t.n(i),o=(t(48),t(49),t(41)),d=t(36),c=t(37),p=t(10),s=t(42),y=t(40),w=t(0),h=t(39),u=t.n(h),f=function(e){Object(s.a)(t,e);var a=Object(y.a)(t);function t(e){var r;return Object(d.a)(this,t),(r=a.call(this,e)).updatePixiCnt=function(e){r.pixi_cnt=e,r.pixi_cnt&&r.pixi_cnt.children.length<=0&&r.pixi_cnt.appendChild(r.app.view),r.init()},r.initSocket=function(){r.socket=u()();var e=r.socket;e.on("connect",(function(){console.log("socket id",e.id)})),e.on("playerPositions",(function(a){var t,n=Object(o.a)(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.id===e.id);else{var l=r.players.get(i.id);l.x=i.x+r.app.view.width/2,l.y=i.y+r.app.view.height/2,r.setAnimation(l,i.dir)}}}catch(d){n.e(d)}finally{n.f()}})),e.on("initPlayers",(function(e){r.createPlayers(e)})),e.on("removePlayer",(function(e){r.removePlayer(e)})),e.on("addPlayer",(function(e){r.addPlayer(e)}))},r.setAnimation=function(e,a){if(!e.playing){switch(a){case"s":e.textures=r.playerSheet.standDown;break;case"u":e.textures=r.playerSheet.walkUp;break;case"d":e.textures=r.playerSheet.walkDown;break;case"r":e.textures=r.playerSheet.walkRight;break;case"l":e.textures=r.playerSheet.walkLeft}e.play()}},r.createPlayers=function(e){e.forEach(function(e){this.addPlayer(e)}.bind(Object(p.a)(r)))},r.addPlayer=function(e){var a=r.createPlayerSprite(e);console.log("adding player",e),r.world.addChild(a),r.players.set(e.id,a)},r.removePlayer=function(e){var a=r.players.get(e);console.log("removing player",e),r.world.removeChild(a),r.players.delete(e)},r.createPlayerSprite=function(e){var a=new w.a(r.playerSheet.standDown);a.anchor.set(.5),a.animationSpeed=.5,a.loop=!1,a.setParent(r.world),a.x=e.x+r.app.view.width/2,a.y=e.y+r.app.view.height/2;return a.width*=.6*r.scale,a.height*=.6*r.scale,a},r.calcRelativePos=function(e,a){return{x:r.calcRelativeX(e),y:r.calcRelativeY(a)}},r.calcRelativeX=function(e){return e+r.world.x+r.app.view.width/2},r.calcRelativeY=function(e){return e+r.world.y+r.app.view.height/2},r.background=function(e,a,t,r){var n=a,i=new w.d,l=(new w.e).beginFill(9160191).drawRect(0,0,e.x,e.y).endFill();function o(){var a={x:n.width,y:n.height};r&&(a=r);var i=e.x/e.y,l=a.x/a.y,o=1,d=new w.f(0,0);("cover"==t?i>l:i<l)?(o=e.x/a.x,d.y=-(a.y*o-e.y)/2):(o=e.y/a.y,d.x=-(a.x*o-e.x)/2),n.scale=new w.f(o,o),n.position=d}return i.mask=l,i.addChild(l),i.addChild(n),o(),{container:i,doResize:o}},r.loadBackground=function(){var e=new w.d,a=new w.h.from(r.app.loader.resources.world.url),t=r.background({x:r.app.view.width,y:r.app.view.height},a,"cover");e.addChild(t.container),r.app.stage.addChild(e)},r.loadBackground2=function(){r.world=new w.d,r.image=new w.h.from(r.app.loader.resources.world.url),r.image.width*=r.scale,r.image.height*=r.scale,r.app.stage.addChild(r.world),r.world.addChild(r.image)},r.doneLoading=function(e){r.loadBackground2(),r.createPlayerSheet(),r.createPlayer();var a={up:!1,down:!1,left:!1,right:!1};r.dir=a,document.onkeydown=function(e){switch(e.key){case"w":a.up=!0;break;case"s":a.down=!0;break;case"d":a.right=!0;break;case"a":a.left=!0}},document.onkeyup=function(e){switch(e.key){case"w":a.up=!1;break;case"s":a.down=!1;break;case"d":a.right=!1;break;case"a":a.left=!1}},window.player=r.player;var t=2.5*r.scale;r.app.ticker.add((function(e){a.down&&(r.player.playing||(r.player.textures=r.playerSheet.walkDown,r.player.play()),r.world.y-=t,r.socket.emit("updatePosition",{x:-r.world.x,y:-r.world.y,dir:"d"})),a.up&&(r.player.playing||(r.player.textures=r.playerSheet.walkUp,r.player.play()),r.world.y+=t,r.socket.emit("updatePosition",{x:-r.world.x,y:-r.world.y,dir:"u"})),a.right&&(r.player.playing||(r.player.textures=r.playerSheet.walkRight,r.player.play()),r.world.x-=t,r.socket.emit("updatePosition",{x:-r.world.x,y:-r.world.y,dir:"r"})),a.left&&(r.player.playing||(r.player.textures=r.playerSheet.walkLeft,r.player.play()),r.world.x+=t,r.socket.emit("updatePosition",{x:-r.world.x,y:-r.world.y,dir:"l"}))})),r.initSocket()},r.createPlayer=function(){r.player=new w.a(r.playerSheet.standDown),r.player.anchor.set(.5),r.player.animationSpeed=.5,r.player.loop=!1,r.player.x=r.app.view.width/2,r.player.y=r.app.view.height/2,r.app.stage.addChild(r.player);r.player.width*=.6*r.scale,r.player.height*=.6*r.scale,r.player.play(),r.player.onComplete=function(){!r.dir.left&&!r.dir.right&&!r.dir.up&&r.dir.down,r.player.textures=r.playerSheet.standDown,r.socket.emit("updatePosition",{x:-r.world.x,y:-r.world.y,dir:"s"})}},r.createPlayerSheet=function(){var e=new w.c.from(r.app.loader.resources.agent.url);function a(e,a){return new w.g(30*e,52*a,30,52)}r.playerSheet={},r.playerSheet.standDown=[new w.i(e,a(0,2))],r.playerSheet.standUp=[new w.i(e,a(0,0))],r.playerSheet.standRight=[new w.i(e,a(0,3))],r.playerSheet.standLeft=[new w.i(e,a(0,1))];for(var t=["walkUp","walkLeft","walkDown","walkRight"],n=0;n<t.length;n++){r.playerSheet[t[n]]=[];for(var i=0;i<9;i++)r.playerSheet[t[n]].push(new w.i(e,a(i,n)))}},r.init=function(){var e=r.app;e.loader.add("agent","assets/agent.png"),e.loader.add("world","assets/world.png"),e.loader.load(r.doneLoading);var a=w.h.from(w.i.WHITE);a.width=200,a.height=200,a.tint=16711680,a.position.x=50,a.position.y=50},r.game=n.a.createRef(),r.pixi_cnt=null,r.app=new w.b({backgroundColor:11184810}),window.app=r.app,r.scale=2,r.players=new Map,r}return Object(c.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{ref:this.updatePixiCnt})}}]),t}(n.a.Component);var g=function(){return n.a.createElement("div",{className:"App"},n.a.createElement("header",{className:"App-header"},n.a.createElement(f,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(g,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[43,1,2]]]);
//# sourceMappingURL=main.c73aa7ec.chunk.js.map